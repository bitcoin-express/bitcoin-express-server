<link href='https://fonts.googleapis.com/css?family=Open+Sans:700,600' rel='stylesheet' type='text/css'>

<div class="box" id="result_messages_box" style="display:none;">
    <h1>Operation result</h1>
    <div id="result_messages">

    </div>
</div>

<form method="post" id="register_form" action="/panel/confirmRegistration">
  <div class="box">
    <h1>Register New Account</h1>

      <small>Domain <span style="color: red">(*)</span>:</small><br />
      <input type="text" id="domain_name" name="domain" value="" class="email" required/>
      <br /><br />

    <small>Account name:</small><br />
    <input type="text" name="account_name" value="" class="email" />
    <br /><br />

    <small>Account Contact Email:</small><br />
    <input type="email" name="email_account_contact" value="" class="email" />
    <br /><br />

    <small>Customer Contact Email:</small><br />
    <input type="email" name="email_customer_contact" value="" class="email" />
    <br /><br />

    <small style="color: red">
      (*) - Mandatory field
    </small>
    <br /><br />

<div style="display: inline-block;">
    <a href="#" id="form_submit">
      <div class="btn">Register</div>
    </a> <!-- End Btn -->
    <a href="/">
      <div id="btn2">Sign In</div>
    </a> <!-- End Btn2 -->
</div>
  </div> <!-- End Box -->

</form>

<div id="register_results" class="box" style="display:none;">
    <h1>New Account Created</h1>
    <small>Domain:</small><br />
    <p id="created_account_domain"></p>
    <small>Account name:</small><br />
    <p id="created_account_name"></p>
    <br />
    <small>Authentication token:</small><br />
    <p id="created_account_auth_token" class="important"></p>
    <small>Admin authentication token:</small><br />
    <p id="created_account_admin_auth_token" class="important"></p>
    <small>Private key:</small><br />
    <p id="created_account_private_key" class="important"></p>
    <div style="display: inline-block;">
        <a href="/">
            <div id="btn2">Sign In</div>
        </a> <!-- End Btn2 -->
    </div>
</div> <!-- End Box -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
    document.getElementById("form_submit").addEventListener("click", function(event){
        event.preventDefault();
        let data = {};

        $("form#register_form :input").each(function(){
            console.log($(this), $(this).attr('name'), $(this).val());
            data[$(this).attr('name')] = $(this).val(); // This is the jquery object of the input, do what you will
        });

        $.ajax({
            type: "POST",
            contentType: "application/json; charset=UTF-8",
            dataType: "json",
            url: "/v1.0a/accounts",
            data: JSON.stringify(data),
            beforeSend: function () {
                $("#result_messages_box").hide();
                $("#result_messages").empty();
            },
            success: function (data, status, jqHXR) {
                $("#created_account_domain").text(data.body[0].domain);
                $("#created_account_name").text(data.body[0].account_name);
                $("#created_account_auth_token").text(data.body[0].auth_token);
                $("#created_account_admin_auth_token").text(data.body[0].admin_auth_token);
                $("#created_account_private_key").text(data.body[0].private_key);
                $("#register_form").hide();
                $("#register_results").show();
            },
            error: function (jqXHR, status, error) {
                let result = JSON.parse(jqXHR.responseText),
                    messages_container = $("#result_messages");

                for (let message of result.messages) {
                    messages_container.append(`<p> <div style="text-transform: capitalize; display: inline;">${message.type}: </div><div style="display: inline;">${message.body}</div></p>`);
                }
                $("#result_messages_box").show();
            },
        });
    });

// document.getElementById("form_submit").onclick = function(event) {

  // var f = document.getElementById("register_form");
  // if (f.checkValidity()) {
  //   f.submit();
  // } else {
  //   f.reportValidity();
  // }
// };
</script>
