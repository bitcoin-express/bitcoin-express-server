<link rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Open+Sans:700,600'>
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.css">

<div style="padding: 20px 15px; margin:  5vh 5vw; background-color: white; border-radius: 10px;">
    <p id="panel" class="section" style="color: black; margin: 0 15px 0 0; text-align: right;">
      {{{json accountId}}} | {{{json accountName}}} | <a href="/panel/logout">
        Logout
      </a><br />
      <span style="font-size: 15px; color: #3498db">
        {{{json btcBalance}}} XBT
      </span>
    </p>

    <h2 style="color: #3498db">Transactions</h2>
    <table id="transactions" class="display" width="100%" cellspacing="0" style="font-size: 11px;">
      <thead>
        <tr>
          <th>Status</th>
          <th>Curr</th>
          <th>Amount</th>
          <th>Fee</th>
          <th>Memo</th>
          <th>Time</th>
          <th>Expires</th>
          <th>PaymentID</th>
          <th>Merchant data</th>
          <th>Return url</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <br />
    <h2 style="color: #3498db">Configuration</h2>
    <table id="settings" class="display" width="100%" cellspacing="0" style="font-size: 11px;">
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
</div>


<script
  src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"
  type="text/javascript"
>
</script>
<script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.js"></script>
<script type="text/javascript" charset="utf8" src="//cdn.datatables.net/plug-ins/1.10.12/dataRender/ellipsis.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js"></script>

<script type="text/javascript">

$(document).ready(function() {
  showTransactions();
  showSettings();
});

var transactionTable = null;
var showTransactions = function() {
    if (transactionTable!=null) {
      transactionTable.destroy();
    }

    transactionTable = $('#transactions').DataTable( {
        data: {{{json transactions}}},
        columns: [
            { data: 'status' },
            { data: 'currency' },
            { data: 'amount' },
            { data: 'verifyInfo.totalFee',
              render: function ( data, type, full, meta ) {
                if(data == null) {
                  return "N/A";
                }
                return data;
            }},
            { data: 'memo' },
            { data: 'time' },
            { data: 'expires' },
            { data: 'payment_id' },
            { data: 'merchant_data',
              render: function ( data, type, full, meta ) {
                      if(data == null) {
                          return "N/A";
                      }
                    return data;
            }},
            { data: 'return_url' }
        ],
        columnDefs: [ {
                targets: 3,
                render: $.fn.dataTable.render.ellipsis(20)
            }, {
                targets: 7,
                render: $.fn.dataTable.render.ellipsis(8)
            }, {
                targets: 8,
                render: $.fn.dataTable.render.ellipsis(8)
            }, {
                targets: 9,
                render: $.fn.dataTable.render.ellipsis(20)
            }
        ],
        "order": [[ 0, "desc" ]]
    });

};

var settingsTable = null;
function showSettings() {
  if (settingsTable != null) {
    settingsTable.destroy();
  }

  settingsTable = $('#settings').DataTable({
    data: {{{json settings}}},
    columns: [
      { data: 'key' },
      { data: 'value' }
    ]
  });
}
</script>
